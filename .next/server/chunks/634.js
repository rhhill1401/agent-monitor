"use strict";exports.id=634,exports.ids=[634],exports.modules={1634:(t,s,e)=>{e.d(s,{s:()=>eI});var i=e(6005);let n=i.webcrypto?.subtle||{};var r=Object.defineProperty;((t,s)=>{for(var e in s)r(t,e,{get:s[e],enumerable:!0})})({},{UpstashError:()=>h,UpstashJSONParseError:()=>o,UrlError:()=>c});var h=class extends Error{constructor(t,s){super(t,s),this.name="UpstashError"}},c=class extends Error{constructor(t){super(`Upstash Redis client was passed an invalid URL. You should pass a URL starting with https. Received: "${t}". `),this.name="UrlError"}},o=class extends h{constructor(t,s){let e=t.length>200?t.slice(0,200)+"...":t;super(`Unable to parse response body: ${e}`,s),this.name="UpstashJSONParseError"}};function parseRecursive(t){let s=Array.isArray(t)?t.map(t=>{try{return parseRecursive(t)}catch{return t}}):JSON.parse(t);return"number"==typeof s&&s.toString()!==t?t:s}function parseResponse(t){try{return parseRecursive(t)}catch{return t}}function deserializeScanResponse(t){return[t[0],...parseResponse(t.slice(1))]}function deserializeScanWithTypesResponse(t){let[s,e]=t,i=[];for(let t=0;t<e.length;t+=2)i.push({key:e[t],type:e[t+1]});return[s,i]}function mergeHeaders(...t){let s={};for(let e of t)if(e)for(let[t,i]of Object.entries(e))null!=i&&(s[t]=i);return s}function kvArrayToObject(t){if("object"==typeof t&&null!==t&&!Array.isArray(t))return t;if(!Array.isArray(t))return{};let s={};for(let e=0;e<t.length;e+=2)"string"==typeof t[e]&&(s[t[e]]=t[e+1]);return s}var a=class{constructor(t){if(this.upstashSyncToken="",this.options={backend:t.options?.backend,agent:t.agent,responseEncoding:t.responseEncoding??"base64",cache:t.cache,signal:t.signal,keepAlive:t.keepAlive??!0},this.upstashSyncToken="",this.readYourWrites=t.readYourWrites??!0,this.baseUrl=(t.baseUrl||"").replace(/\/$/,""),this.baseUrl&&!/^https?:\/\/[^\s#$./?].\S*$/.test(this.baseUrl))throw new c(this.baseUrl);this.headers={"Content-Type":"application/json",...t.headers},this.hasCredentials=!!(this.baseUrl&&this.headers.authorization.split(" ")[1]),"base64"===this.options.responseEncoding&&(this.headers["Upstash-Encoding"]="base64"),this.retry="boolean"!=typeof t.retry||t.retry?{attempts:t.retry?.retries??5,backoff:t.retry?.backoff??(t=>50*Math.exp(t))}:{attempts:1,backoff:()=>0}}mergeTelemetry(t){this.headers=merge(this.headers,"Upstash-Telemetry-Runtime",t.runtime),this.headers=merge(this.headers,"Upstash-Telemetry-Platform",t.platform),this.headers=merge(this.headers,"Upstash-Telemetry-Sdk",t.sdk)}async request(t){let s;let e=mergeHeaders(this.headers,t.headers??{}),i=[this.baseUrl,...t.path??[]].join("/"),n="text/event-stream"===e.Accept,r=t.signal??this.options.signal,c="function"==typeof r,a={cache:this.options.cache,method:"POST",headers:e,body:JSON.stringify(t.body),keepalive:this.options.keepAlive,agent:this.options.agent,signal:c?r():r,backend:this.options.backend};if(this.hasCredentials||console.warn("[Upstash Redis] Redis client was initialized without url or token. Failed to execute command."),this.readYourWrites){let t=this.upstashSyncToken;this.headers["upstash-sync-token"]=t}let p=null,l=null;for(let t=0;t<=this.retry.attempts;t++)try{p=await fetch(i,a);break}catch(s){if(a.signal?.aborted&&c)throw s;if(a.signal?.aborted){let t=new Blob([JSON.stringify({result:a.signal.reason??"Aborted"})]),s={status:200,statusText:a.signal.reason??"Aborted"};p=new Response(t,s);break}l=s,t<this.retry.attempts&&await new Promise(s=>setTimeout(s,this.retry.backoff(t)))}if(!p)throw l??Error("Exhausted all retries");if(!p.ok){let s;let e=await p.text();try{s=JSON.parse(e)}catch(t){throw new o(e,{cause:t})}throw new h(`${s.error}, command was: ${JSON.stringify(t.body)}`)}if(this.readYourWrites){let t=p.headers;this.upstashSyncToken=t.get("upstash-sync-token")??""}if(n&&t&&t.onMessage&&p.body){let s=p.body.getReader(),e=new TextDecoder;return(async()=>{try{let i="";for(;;){let{value:n,done:r}=await s.read();if(r)break;i+=e.decode(n,{stream:!0});let h=i.split("\n");if((i=h.pop()||"").length>1048576)throw Error("Buffer size exceeded (1MB)");for(let s of h)if(s.startsWith("data: ")){let e=s.slice(6);t.onMessage?.(e)}}}catch(t){t instanceof Error&&"AbortError"===t.name||console.error("Stream reading error:",t)}finally{try{await s.cancel()}catch{}}})(),{result:1}}let u=await p.text();try{s=JSON.parse(u)}catch(t){throw new o(u,{cause:t})}if(this.readYourWrites){let t=p.headers;this.upstashSyncToken=t.get("upstash-sync-token")??""}if("base64"===this.options.responseEncoding){if(Array.isArray(s))return s.map(({result:t,error:s})=>({result:decode(t),error:s}));let t=decode(s.result);return{result:t,error:s.error}}return s}};function base64decode(t){let s="";try{let e=atob(t),i=e.length,n=new Uint8Array(i);for(let t=0;t<i;t++)n[t]=e.charCodeAt(t);s=new TextDecoder().decode(n)}catch{s=t}return s}function decode(t){let s;switch(typeof t){case"undefined":return t;case"number":s=t;break;case"object":s=Array.isArray(t)?t.map(t=>"string"==typeof t?base64decode(t):Array.isArray(t)?t.map(t=>decode(t)):t):null;break;case"string":s="OK"===t?"OK":base64decode(t)}return s}function merge(t,s,e){return e&&(t[s]=t[s]?[t[s],e].join(","):e),t}var defaultSerializer=t=>{switch(typeof t){case"string":case"number":case"boolean":return t;default:return JSON.stringify(t)}},p=class{constructor(t,s){if(this.serialize=defaultSerializer,this.deserialize=s?.automaticDeserialization===void 0||s.automaticDeserialization?s?.deserialize??parseResponse:t=>t,this.command=t.map(t=>this.serialize(t)),this.headers=s?.headers,this.path=s?.path,this.onMessage=s?.streamOptions?.onMessage,this.isStreaming=s?.streamOptions?.isStreaming??!1,this.signal=s?.streamOptions?.signal,s?.latencyLogging){let t=this.exec.bind(this);this.exec=async s=>{let e=performance.now(),i=await t(s),n=performance.now(),r=(n-e).toFixed(2);return console.log(`Latency for \x1b[38;2;19;185;39m${this.command[0].toString().toUpperCase()}\x1b[0m: \x1b[38;2;0;255;255m${r} ms\x1b[0m`),i}}}async exec(t){let{result:s,error:e}=await t.request({body:this.command,path:this.path,upstashSyncToken:t.upstashSyncToken,headers:this.headers,onMessage:this.onMessage,isStreaming:this.isStreaming,signal:this.signal});if(e)throw new h(e);if(void 0===s)throw TypeError("Request did not return a result");return this.deserialize(s)}};function deserialize(t){if(0===t.length)return null;let s={};for(let e=0;e<t.length;e+=2){let i=t[e],n=t[e+1];try{s[i]=JSON.parse(n)}catch{s[i]=n}}return s}var l=class extends p{constructor(t,s){let e=["hrandfield",t[0]];"number"==typeof t[1]&&e.push(t[1]),t[2]&&e.push("WITHVALUES"),super(e,{deserialize:t[2]?t=>deserialize(t):s?.deserialize,...s})}},u=class extends p{constructor(t,s){super(["append",...t],s)}},d=class extends p{constructor([t,s,e],i){let n=["bitcount",t];"number"==typeof s&&n.push(s),"number"==typeof e&&n.push(e),super(n,i)}},m=class{constructor(t,s,e,i=t=>t.exec(this.client)){this.client=s,this.opts=e,this.execOperation=i,this.command=["bitfield",...t]}chain(...t){return this.command.push(...t),this}get(...t){return this.chain("get",...t)}set(...t){return this.chain("set",...t)}incrby(...t){return this.chain("incrby",...t)}overflow(t){return this.chain("overflow",t)}exec(){let t=new p(this.command,this.opts);return this.execOperation(t)}},x=class extends p{constructor(t,s){super(["bitop",...t],s)}},w=class extends p{constructor(t,s){super(["bitpos",...t],s)}},y=class extends p{constructor([t,s],e){super(["CLIENT","SETINFO",t.toUpperCase(),s],e)}},g=class extends p{constructor([t,s,e],i){super(["COPY",t,s,...e?.replace?["REPLACE"]:[]],{...i,deserialize:t=>t>0?"COPIED":"NOT_COPIED"})}},O=class extends p{constructor(t){super(["dbsize"],t)}},f=class extends p{constructor(t,s){super(["decr",...t],s)}},b=class extends p{constructor(t,s){super(["decrby",...t],s)}},E=class extends p{constructor(t,s){super(["del",...t],s)}},S=class extends p{constructor(t,s){super(["echo",...t],s)}},A=class extends p{constructor([t,s,e],i){super(["eval_ro",t,s.length,...s,...e??[]],i)}},T=class extends p{constructor([t,s,e],i){super(["eval",t,s.length,...s,...e??[]],i)}},R=class extends p{constructor([t,s,e],i){super(["evalsha_ro",t,s.length,...s,...e??[]],i)}},z=class extends p{constructor([t,s,e],i){super(["evalsha",t,s.length,...s,...e??[]],i)}},v=class extends p{constructor(t,s){let e=t.map(t=>"string"==typeof t?t:String(t));super(e,s)}},N=class extends p{constructor(t,s){super(["exists",...t],s)}},k=class extends p{constructor(t,s){super(["expire",...t.filter(Boolean)],s)}},P=class extends p{constructor(t,s){super(["expireat",...t],s)}},C=class extends p{constructor([t,s,e],i){super(["fcall",t,...s?[s.length,...s]:[0],...e??[]],i)}},U=class extends p{constructor([t,s,e],i){super(["fcall_ro",t,...s?[s.length,...s]:[0],...e??[]],i)}},I=class extends p{constructor(t,s){let e=["flushall"];t&&t.length>0&&t[0].async&&e.push("async"),super(e,s)}},L=class extends p{constructor([t],s){let e=["flushdb"];t?.async&&e.push("async"),super(e,s)}},D=class extends p{constructor([t],s){super(["function","delete",t],s)}},M=class extends p{constructor(t){super(["function","flush"],t)}},j=class extends p{constructor([t],s){let e=["function","list"];t?.libraryName&&e.push("libraryname",t.libraryName),t?.withCode&&e.push("withcode"),super(e,{deserialize:deserialize2,...s})}};function deserialize2(t){return Array.isArray(t)?t.map(t=>{let s=kvArrayToObject(t),e=s.functions.map(t=>kvArrayToObject(t));return{libraryName:s.library_name,engine:s.engine,functions:e.map(t=>({name:t.name,description:t.description??void 0,flags:t.flags})),libraryCode:s.library_code}}):[]}var J=class extends p{constructor([t],s){super(["function","load",...t.replace?["replace"]:[],t.code],s)}},X=class extends p{constructor(t){super(["function","stats"],{deserialize:deserialize3,...t})}};function deserialize3(t){let s=kvArrayToObject(kvArrayToObject(t).engines),e=Object.fromEntries(Object.entries(s).map(([t,s])=>[t,kvArrayToObject(s)])),i={engines:Object.fromEntries(Object.entries(e).map(([t,s])=>[t,{librariesCount:s.libraries_count,functionsCount:s.functions_count}]))};return i}var F=class extends p{constructor([t,s,...e],i){let n=["geoadd",t];"nx"in s&&s.nx?n.push("nx"):"xx"in s&&s.xx&&n.push("xx"),"ch"in s&&s.ch&&n.push("ch"),"latitude"in s&&s.latitude&&n.push(s.longitude,s.latitude,s.member),n.push(...e.flatMap(({latitude:t,longitude:s,member:e})=>[s,t,e])),super(n,i)}},_=class extends p{constructor([t,s,e,i="M"],n){super(["GEODIST",t,s,e,i],n)}},W=class extends p{constructor(t,s){let[e]=t,i=Array.isArray(t[1])?t[1]:t.slice(1);super(["GEOHASH",e,...i],s)}},Y=class extends p{constructor(t,s){let[e]=t,i=Array.isArray(t[1])?t[1]:t.slice(1);super(["GEOPOS",e,...i],{deserialize:t=>transform(t),...s})}};function transform(t){let s=[];for(let e of t)e?.[0]&&e?.[1]&&s.push({lng:Number.parseFloat(e[0]),lat:Number.parseFloat(e[1])});return s}var $=class extends p{constructor([t,s,e,i,n],r){let h=["GEOSEARCH",t];("FROMMEMBER"===s.type||"frommember"===s.type)&&h.push(s.type,s.member),("FROMLONLAT"===s.type||"fromlonlat"===s.type)&&h.push(s.type,s.coordinate.lon,s.coordinate.lat),("BYRADIUS"===e.type||"byradius"===e.type)&&h.push(e.type,e.radius,e.radiusType),("BYBOX"===e.type||"bybox"===e.type)&&h.push(e.type,e.rect.width,e.rect.height,e.rectType),h.push(i),n?.count&&h.push("COUNT",n.count.limit,...n.count.any?["ANY"]:[]),super([...h,...n?.withCoord?["WITHCOORD"]:[],...n?.withDist?["WITHDIST"]:[],...n?.withHash?["WITHHASH"]:[]],{deserialize:t=>n?.withCoord||n?.withDist||n?.withHash?t.map(t=>{let s=1,e={};try{e.member=JSON.parse(t[0])}catch{e.member=t[0]}return n.withDist&&(e.dist=Number.parseFloat(t[s++])),n.withHash&&(e.hash=t[s++].toString()),n.withCoord&&(e.coord={long:Number.parseFloat(t[s][0]),lat:Number.parseFloat(t[s][1])}),e}):t.map(t=>{try{return{member:JSON.parse(t)}}catch{return{member:t}}}),...r})}},H=class extends p{constructor([t,s,e,i,n,r],h){let c=["GEOSEARCHSTORE",t,s];("FROMMEMBER"===e.type||"frommember"===e.type)&&c.push(e.type,e.member),("FROMLONLAT"===e.type||"fromlonlat"===e.type)&&c.push(e.type,e.coordinate.lon,e.coordinate.lat),("BYRADIUS"===i.type||"byradius"===i.type)&&c.push(i.type,i.radius,i.radiusType),("BYBOX"===i.type||"bybox"===i.type)&&c.push(i.type,i.rect.width,i.rect.height,i.rectType),c.push(n),r?.count&&c.push("COUNT",r.count.limit,...r.count.any?["ANY"]:[]),super([...c,...r?.storeDist?["STOREDIST"]:[]],h)}},B=class extends p{constructor(t,s){super(["get",...t],s)}},G=class extends p{constructor(t,s){super(["getbit",...t],s)}},K=class extends p{constructor(t,s){super(["getdel",...t],s)}},q=class extends p{constructor([t,s],e){let i=["getex",t];s&&("ex"in s&&"number"==typeof s.ex?i.push("ex",s.ex):"px"in s&&"number"==typeof s.px?i.push("px",s.px):"exat"in s&&"number"==typeof s.exat?i.push("exat",s.exat):"pxat"in s&&"number"==typeof s.pxat?i.push("pxat",s.pxat):"persist"in s&&s.persist&&i.push("persist")),super(i,e)}},V=class extends p{constructor(t,s){super(["getrange",...t],s)}},Q=class extends p{constructor(t,s){super(["getset",...t],s)}},Z=class extends p{constructor(t,s){super(["hdel",...t],s)}},tt=class extends p{constructor(t,s){super(["hexists",...t],s)}},ts=class extends p{constructor(t,s){let[e,i,n,r]=t,h=Array.isArray(i)?i:[i];super(["hexpire",e,n,...r?[r]:[],"FIELDS",h.length,...h],s)}},te=class extends p{constructor(t,s){let[e,i,n,r]=t,h=Array.isArray(i)?i:[i];super(["hexpireat",e,n,...r?[r]:[],"FIELDS",h.length,...h],s)}},ti=class extends p{constructor(t,s){let[e,i]=t,n=Array.isArray(i)?i:[i];super(["hexpiretime",e,"FIELDS",n.length,...n],s)}},tn=class extends p{constructor(t,s){let[e,i]=t,n=Array.isArray(i)?i:[i];super(["hpersist",e,"FIELDS",n.length,...n],s)}},tr=class extends p{constructor(t,s){let[e,i,n,r]=t,h=Array.isArray(i)?i:[i];super(["hpexpire",e,n,...r?[r]:[],"FIELDS",h.length,...h],s)}},th=class extends p{constructor(t,s){let[e,i,n,r]=t,h=Array.isArray(i)?i:[i];super(["hpexpireat",e,n,...r?[r]:[],"FIELDS",h.length,...h],s)}},tc=class extends p{constructor(t,s){let[e,i]=t,n=Array.isArray(i)?i:[i];super(["hpexpiretime",e,"FIELDS",n.length,...n],s)}},to=class extends p{constructor(t,s){let[e,i]=t,n=Array.isArray(i)?i:[i];super(["hpttl",e,"FIELDS",n.length,...n],s)}},ta=class extends p{constructor(t,s){super(["hget",...t],s)}};function deserialize4(t){if(0===t.length)return null;let s={};for(let e=0;e<t.length;e+=2){let i=t[e],n=t[e+1];try{let t=!Number.isNaN(Number(n))&&!Number.isSafeInteger(Number(n));s[i]=t?n:JSON.parse(n)}catch{s[i]=n}}return s}var tp=class extends p{constructor(t,s){super(["hgetall",...t],{deserialize:t=>deserialize4(t),...s})}};function deserialize5(t,s){if(s.every(t=>null===t))return null;let e={};for(let[i,n]of t.entries())try{e[n]=JSON.parse(s[i])}catch{e[n]=s[i]}return e}var tl=class extends p{constructor([t,...s],e){super(["hmget",t,...s],{deserialize:t=>deserialize5(s,t),...e})}},tu=class extends p{constructor([t,...s],e){super(["hgetdel",t,"FIELDS",s.length,...s],{deserialize:t=>deserialize5(s.map(String),t),...e})}},td=class extends p{constructor([t,s,...e],i){let n=["hgetex",t];"ex"in s&&"number"==typeof s.ex?n.push("EX",s.ex):"px"in s&&"number"==typeof s.px?n.push("PX",s.px):"exat"in s&&"number"==typeof s.exat?n.push("EXAT",s.exat):"pxat"in s&&"number"==typeof s.pxat?n.push("PXAT",s.pxat):"persist"in s&&s.persist&&n.push("PERSIST"),n.push("FIELDS",e.length,...e),super(n,{deserialize:t=>deserialize5(e.map(String),t),...i})}},tm=class extends p{constructor(t,s){super(["hincrby",...t],s)}},tx=class extends p{constructor(t,s){super(["hincrbyfloat",...t],s)}},tw=class extends p{constructor([t],s){super(["hkeys",t],s)}},ty=class extends p{constructor(t,s){super(["hlen",...t],s)}},tg=class extends p{constructor([t,s],e){super(["hmset",t,...Object.entries(s).flatMap(([t,s])=>[t,s])],e)}},tO=class extends p{constructor([t,s,e],i){let n=["hscan",t,s];e?.match&&n.push("match",e.match),"number"==typeof e?.count&&n.push("count",e.count),super(n,{deserialize:deserializeScanResponse,...i})}},tf=class extends p{constructor([t,s],e){super(["hset",t,...Object.entries(s).flatMap(([t,s])=>[t,s])],e)}},tb=class extends p{constructor([t,s,e],i){let n=["hsetex",t];s.conditional&&n.push(s.conditional.toUpperCase()),s.expiration&&("ex"in s.expiration&&"number"==typeof s.expiration.ex?n.push("EX",s.expiration.ex):"px"in s.expiration&&"number"==typeof s.expiration.px?n.push("PX",s.expiration.px):"exat"in s.expiration&&"number"==typeof s.expiration.exat?n.push("EXAT",s.expiration.exat):"pxat"in s.expiration&&"number"==typeof s.expiration.pxat?n.push("PXAT",s.expiration.pxat):"keepttl"in s.expiration&&s.expiration.keepttl&&n.push("KEEPTTL"));let r=Object.entries(e);for(let[t,s]of(n.push("FIELDS",r.length),r))n.push(t,s);super(n,i)}},tE=class extends p{constructor(t,s){super(["hsetnx",...t],s)}},tS=class extends p{constructor(t,s){super(["hstrlen",...t],s)}},tA=class extends p{constructor(t,s){let[e,i]=t,n=Array.isArray(i)?i:[i];super(["httl",e,"FIELDS",n.length,...n],s)}},tT=class extends p{constructor(t,s){super(["hvals",...t],s)}},tR=class extends p{constructor(t,s){super(["incr",...t],s)}},tz=class extends p{constructor(t,s){super(["incrby",...t],s)}},tv=class extends p{constructor(t,s){super(["incrbyfloat",...t],s)}},tN=class extends p{constructor(t,s){super(["JSON.ARRAPPEND",...t],s)}},tk=class extends p{constructor(t,s){super(["JSON.ARRINDEX",...t],s)}},tP=class extends p{constructor(t,s){super(["JSON.ARRINSERT",...t],s)}},tC=class extends p{constructor(t,s){super(["JSON.ARRLEN",t[0],t[1]??"$"],s)}},tU=class extends p{constructor(t,s){super(["JSON.ARRPOP",...t],s)}},tI=class extends p{constructor(t,s){let e=t[1]??"$",i=t[2]??0,n=t[3]??0;super(["JSON.ARRTRIM",t[0],e,i,n],s)}},tL=class extends p{constructor(t,s){super(["JSON.CLEAR",...t],s)}},tD=class extends p{constructor(t,s){super(["JSON.DEL",...t],s)}},tM=class extends p{constructor(t,s){super(["JSON.FORGET",...t],s)}},tj=class extends p{constructor(t,s){let e=["JSON.GET"];"string"==typeof t[1]?e.push(...t):(e.push(t[0]),t[1]&&(t[1].indent&&e.push("INDENT",t[1].indent),t[1].newline&&e.push("NEWLINE",t[1].newline),t[1].space&&e.push("SPACE",t[1].space)),e.push(...t.slice(2))),super(e,s)}},tJ=class extends p{constructor(t,s){let e=["JSON.MERGE",...t];super(e,s)}},tX=class extends p{constructor(t,s){super(["JSON.MGET",...t[0],t[1]],s)}},tF=class extends p{constructor(t,s){let e=["JSON.MSET"];for(let s of t)e.push(s.key,s.path,s.value);super(e,s)}},t_=class extends p{constructor(t,s){super(["JSON.NUMINCRBY",...t],s)}},tW=class extends p{constructor(t,s){super(["JSON.NUMMULTBY",...t],s)}},tY=class extends p{constructor(t,s){super(["JSON.OBJKEYS",...t],s)}},t$=class extends p{constructor(t,s){super(["JSON.OBJLEN",...t],s)}},tH=class extends p{constructor(t,s){super(["JSON.RESP",...t],s)}},tB=class extends p{constructor(t,s){let e=["JSON.SET",t[0],t[1],t[2]];t[3]&&(t[3].nx?e.push("NX"):t[3].xx&&e.push("XX")),super(e,s)}},tG=class extends p{constructor(t,s){super(["JSON.STRAPPEND",...t],s)}},tK=class extends p{constructor(t,s){super(["JSON.STRLEN",...t],s)}},tq=class extends p{constructor(t,s){super(["JSON.TOGGLE",...t],s)}},tV=class extends p{constructor(t,s){super(["JSON.TYPE",...t],s)}},tQ=class extends p{constructor(t,s){super(["keys",...t],s)}},tZ=class extends p{constructor(t,s){super(["lindex",...t],s)}},t1=class extends p{constructor(t,s){super(["linsert",...t],s)}},t0=class extends p{constructor(t,s){super(["llen",...t],s)}},t2=class extends p{constructor(t,s){super(["lmove",...t],s)}},t6=class extends p{constructor(t,s){let[e,i,n,r]=t;super(["LMPOP",e,...i,n,...r?["COUNT",r]:[]],s)}},t5=class extends p{constructor(t,s){super(["lpop",...t],s)}},t3=class extends p{constructor(t,s){let e=["lpos",t[0],t[1]];"number"==typeof t[2]?.rank&&e.push("rank",t[2].rank),"number"==typeof t[2]?.count&&e.push("count",t[2].count),"number"==typeof t[2]?.maxLen&&e.push("maxLen",t[2].maxLen),super(e,s)}},t4=class extends p{constructor(t,s){super(["lpush",...t],s)}},t8=class extends p{constructor(t,s){super(["lpushx",...t],s)}},t9=class extends p{constructor(t,s){super(["lrange",...t],s)}},t7=class extends p{constructor(t,s){super(["lrem",...t],s)}},st=class extends p{constructor(t,s){super(["lset",...t],s)}},ss=class extends p{constructor(t,s){super(["ltrim",...t],s)}},se=class extends p{constructor(t,s){let e=Array.isArray(t[0])?t[0]:t;super(["mget",...e],s)}},si=class extends p{constructor([t],s){super(["mset",...Object.entries(t).flatMap(([t,s])=>[t,s])],s)}},sn=class extends p{constructor([t],s){super(["msetnx",...Object.entries(t).flat()],s)}},sr=class extends p{constructor(t,s){super(["persist",...t],s)}},sh=class extends p{constructor(t,s){super(["pexpire",...t],s)}},sc=class extends p{constructor(t,s){super(["pexpireat",...t],s)}},so=class extends p{constructor(t,s){super(["pfadd",...t],s)}},sa=class extends p{constructor(t,s){super(["pfcount",...t],s)}},sp=class extends p{constructor(t,s){super(["pfmerge",...t],s)}},sl=class extends p{constructor(t,s){let e=["ping"];t?.[0]!==void 0&&e.push(t[0]),super(e,s)}},su=class extends p{constructor(t,s){super(["psetex",...t],s)}},sd=class extends p{constructor(t,s){super(["pttl",...t],s)}},sm=class extends p{constructor(t,s){super(["publish",...t],s)}},sx=class extends p{constructor(t){super(["randomkey"],t)}},sw=class extends p{constructor(t,s){super(["rename",...t],s)}},sy=class extends p{constructor(t,s){super(["renamenx",...t],s)}},sg=class extends p{constructor(t,s){super(["rpop",...t],s)}},sO=class extends p{constructor(t,s){super(["rpush",...t],s)}},sf=class extends p{constructor(t,s){super(["rpushx",...t],s)}},sb=class extends p{constructor(t,s){super(["sadd",...t],s)}},sE=class extends p{constructor([t,s],e){let i=["scan",t];s?.match&&i.push("match",s.match),"number"==typeof s?.count&&i.push("count",s.count),s&&"withType"in s&&!0===s.withType?i.push("withtype"):s&&"type"in s&&s.type&&s.type.length>0&&i.push("type",s.type),super(i,{deserialize:s?.withType?deserializeScanWithTypesResponse:deserializeScanResponse,...e})}},sS=class extends p{constructor(t,s){super(["scard",...t],s)}},sA=class extends p{constructor(t,s){super(["script","exists",...t],{deserialize:t=>t,...s})}},sT=class extends p{constructor([t],s){let e=["script","flush"];t?.sync?e.push("sync"):t?.async&&e.push("async"),super(e,s)}},sR=class extends p{constructor(t,s){super(["script","load",...t],s)}},sz=class extends p{constructor(t,s){super(["sdiff",...t],s)}},sv=class extends p{constructor(t,s){super(["sdiffstore",...t],s)}},sN=class extends p{constructor([t,s,e],i){let n=["set",t,s];e&&("nx"in e&&e.nx?n.push("nx"):"xx"in e&&e.xx&&n.push("xx"),"get"in e&&e.get&&n.push("get"),"ex"in e&&"number"==typeof e.ex?n.push("ex",e.ex):"px"in e&&"number"==typeof e.px?n.push("px",e.px):"exat"in e&&"number"==typeof e.exat?n.push("exat",e.exat):"pxat"in e&&"number"==typeof e.pxat?n.push("pxat",e.pxat):"keepTtl"in e&&e.keepTtl&&n.push("keepTtl")),super(n,i)}},sk=class extends p{constructor(t,s){super(["setbit",...t],s)}},sP=class extends p{constructor(t,s){super(["setex",...t],s)}},sC=class extends p{constructor(t,s){super(["setnx",...t],s)}},sU=class extends p{constructor(t,s){super(["setrange",...t],s)}},sI=class extends p{constructor(t,s){super(["sinter",...t],s)}},sL=class extends p{constructor(t,s){super(["sinterstore",...t],s)}},sD=class extends p{constructor(t,s){super(["sismember",...t],s)}},sM=class extends p{constructor(t,s){super(["smembers",...t],s)}},sj=class extends p{constructor(t,s){super(["smismember",t[0],...t[1]],s)}},sJ=class extends p{constructor(t,s){super(["smove",...t],s)}},sX=class extends p{constructor([t,s],e){let i=["spop",t];"number"==typeof s&&i.push(s),super(i,e)}},sF=class extends p{constructor([t,s],e){let i=["srandmember",t];"number"==typeof s&&i.push(s),super(i,e)}},s_=class extends p{constructor(t,s){super(["srem",...t],s)}},sW=class extends p{constructor([t,s,e],i){let n=["sscan",t,s];e?.match&&n.push("match",e.match),"number"==typeof e?.count&&n.push("count",e.count),super(n,{deserialize:deserializeScanResponse,...i})}},sY=class extends p{constructor(t,s){super(["strlen",...t],s)}},s$=class extends p{constructor(t,s){super(["sunion",...t],s)}},sH=class extends p{constructor(t,s){super(["sunionstore",...t],s)}},sB=class extends p{constructor(t){super(["time"],t)}},sG=class extends p{constructor(t,s){super(["touch",...t],s)}},sK=class extends p{constructor(t,s){super(["ttl",...t],s)}},sq=class extends p{constructor(t,s){super(["type",...t],s)}},sV=class extends p{constructor(t,s){super(["unlink",...t],s)}},sQ=class extends p{constructor([t,s,e],i){let n=Array.isArray(e)?[...e]:[e];super(["XACK",t,s,...n],i)}},sZ=class extends p{constructor([t,s,e,...i],n){let r=["XACKDEL",t,s];r.push(e.toUpperCase()),r.push("IDS",i.length,...i),super(r,n)}},s1=class extends p{constructor([t,s,e,i],n){let r=["XADD",t];for(let[t,n]of(i&&(i.nomkStream&&r.push("NOMKSTREAM"),i.trim&&(r.push(i.trim.type,i.trim.comparison,i.trim.threshold),void 0!==i.trim.limit&&r.push("LIMIT",i.trim.limit))),r.push(s),Object.entries(e)))r.push(t,n);super(r,n)}},s0=class extends p{constructor([t,s,e,i,n,r],h){let c=[];r?.count&&c.push("COUNT",r.count),r?.justId&&c.push("JUSTID"),super(["XAUTOCLAIM",t,s,e,i,n,...c],h)}},s2=class extends p{constructor([t,s,e,i,n,r],h){let c=Array.isArray(n)?[...n]:[n],o=[];r?.idleMS&&o.push("IDLE",r.idleMS),r?.idleMS&&o.push("TIME",r.timeMS),r?.retryCount&&o.push("RETRYCOUNT",r.retryCount),r?.force&&o.push("FORCE"),r?.justId&&o.push("JUSTID"),r?.lastId&&o.push("LASTID",r.lastId),super(["XCLAIM",t,s,e,i,...c,...o],h)}},s6=class extends p{constructor([t,s],e){let i=Array.isArray(s)?[...s]:[s];super(["XDEL",t,...i],e)}},s5=class extends p{constructor([t,s,...e],i){let n=["XDELEX",t];s&&n.push(s.toUpperCase()),n.push("IDS",e.length,...e),super(n,i)}},s3=class extends p{constructor([t,s],e){let i=["XGROUP"];switch(s.type){case"CREATE":i.push("CREATE",t,s.group,s.id),s.options&&(s.options.MKSTREAM&&i.push("MKSTREAM"),void 0!==s.options.ENTRIESREAD&&i.push("ENTRIESREAD",s.options.ENTRIESREAD.toString()));break;case"CREATECONSUMER":i.push("CREATECONSUMER",t,s.group,s.consumer);break;case"DELCONSUMER":i.push("DELCONSUMER",t,s.group,s.consumer);break;case"DESTROY":i.push("DESTROY",t,s.group);break;case"SETID":i.push("SETID",t,s.group,s.id),s.options?.ENTRIESREAD!==void 0&&i.push("ENTRIESREAD",s.options.ENTRIESREAD.toString());break;default:throw Error("Invalid XGROUP")}super(i,e)}},s4=class extends p{constructor([t,s],e){let i=[];"CONSUMERS"===s.type?i.push("CONSUMERS",t,s.group):i.push("GROUPS",t),super(["XINFO",...i],e)}},s8=class extends p{constructor(t,s){super(["XLEN",...t],s)}},s9=class extends p{constructor([t,s,e,i,n,r],h){let c=r?.consumer===void 0?[]:Array.isArray(r.consumer)?[...r.consumer]:[r.consumer];super(["XPENDING",t,s,...r?.idleTime?["IDLE",r.idleTime]:[],e,i,n,...c],h)}};function deserialize6(t){let s={};for(let e of t)for(let t=0;t<e.length;t+=2){let i=e[t],n=e[t+1];i in s||(s[i]={});for(let t=0;t<n.length;t+=2){let e=n[t],r=n[t+1];try{s[i][e]=JSON.parse(r)}catch{s[i][e]=r}}}return s}var s7=class extends p{constructor([t,s,e,i],n){let r=["XRANGE",t,s,e];"number"==typeof i&&r.push("COUNT",i),super(r,{deserialize:t=>deserialize6(t),...n})}},et=class extends p{constructor([t,s,e],i){if(Array.isArray(t)&&Array.isArray(s)&&t.length!==s.length)throw Error("ERR Unbalanced XREAD list of streams: for each stream key an ID or '$' must be specified");let n=[];"number"==typeof e?.count&&n.push("COUNT",e.count),"number"==typeof e?.blockMS&&n.push("BLOCK",e.blockMS),n.push("STREAMS",...Array.isArray(t)?[...t]:[t],...Array.isArray(s)?[...s]:[s]),super(["XREAD",...n],i)}},es=class extends p{constructor([t,s,e,i,n],r){if(Array.isArray(e)&&Array.isArray(i)&&e.length!==i.length)throw Error("ERR Unbalanced XREADGROUP list of streams: for each stream key an ID or '$' must be specified");let h=[];"number"==typeof n?.count&&h.push("COUNT",n.count),"number"==typeof n?.blockMS&&h.push("BLOCK",n.blockMS),"boolean"==typeof n?.NOACK&&n.NOACK&&h.push("NOACK"),h.push("STREAMS",...Array.isArray(e)?[...e]:[e],...Array.isArray(i)?[...i]:[i]),super(["XREADGROUP","GROUP",t,s,...h],r)}},ee=class extends p{constructor([t,s,e,i],n){let r=["XREVRANGE",t,s,e];"number"==typeof i&&r.push("COUNT",i),super(r,{deserialize:t=>deserialize7(t),...n})}};function deserialize7(t){let s={};for(let e of t)for(let t=0;t<e.length;t+=2){let i=e[t],n=e[t+1];i in s||(s[i]={});for(let t=0;t<n.length;t+=2){let e=n[t],r=n[t+1];try{s[i][e]=JSON.parse(r)}catch{s[i][e]=r}}}return s}var ei=class extends p{constructor([t,s],e){let{limit:i,strategy:n,threshold:r,exactness:h="~"}=s;super(["XTRIM",t,n,h,r,...i?["LIMIT",i]:[]],e)}},en=class extends p{constructor([t,s,...e],i){let n=["zadd",t];"nx"in s&&s.nx?n.push("nx"):"xx"in s&&s.xx&&n.push("xx"),"ch"in s&&s.ch&&n.push("ch"),"incr"in s&&s.incr&&n.push("incr"),"lt"in s&&s.lt?n.push("lt"):"gt"in s&&s.gt&&n.push("gt"),"score"in s&&"member"in s&&n.push(s.score,s.member),n.push(...e.flatMap(({score:t,member:s})=>[t,s])),super(n,i)}},er=class extends p{constructor(t,s){super(["zcard",...t],s)}},eh=class extends p{constructor(t,s){super(["zcount",...t],s)}},ec=class extends p{constructor(t,s){super(["zincrby",...t],s)}},eo=class extends p{constructor([t,s,e,i],n){let r=["zinterstore",t,s];Array.isArray(e)?r.push(...e):r.push(e),i&&("weights"in i&&i.weights?r.push("weights",...i.weights):"weight"in i&&"number"==typeof i.weight&&r.push("weights",i.weight),"aggregate"in i&&r.push("aggregate",i.aggregate)),super(r,n)}},ea=class extends p{constructor(t,s){super(["zlexcount",...t],s)}},ep=class extends p{constructor([t,s],e){let i=["zpopmax",t];"number"==typeof s&&i.push(s),super(i,e)}},el=class extends p{constructor([t,s],e){let i=["zpopmin",t];"number"==typeof s&&i.push(s),super(i,e)}},eu=class extends p{constructor([t,s,e,i],n){let r=["zrange",t,s,e];i?.byScore&&r.push("byscore"),i?.byLex&&r.push("bylex"),i?.rev&&r.push("rev"),i?.count!==void 0&&void 0!==i.offset&&r.push("limit",i.offset,i.count),i?.withScores&&r.push("withscores"),super(r,n)}},ed=class extends p{constructor(t,s){super(["zrank",...t],s)}},em=class extends p{constructor(t,s){super(["zrem",...t],s)}},ex=class extends p{constructor(t,s){super(["zremrangebylex",...t],s)}},ew=class extends p{constructor(t,s){super(["zremrangebyrank",...t],s)}},ey=class extends p{constructor(t,s){super(["zremrangebyscore",...t],s)}},eg=class extends p{constructor(t,s){super(["zrevrank",...t],s)}},eO=class extends p{constructor([t,s,e],i){let n=["zscan",t,s];e?.match&&n.push("match",e.match),"number"==typeof e?.count&&n.push("count",e.count),super(n,{deserialize:deserializeScanResponse,...i})}},ef=class extends p{constructor(t,s){super(["zscore",...t],s)}},eb=class extends p{constructor([t,s,e],i){let n=["zunion",t];Array.isArray(s)?n.push(...s):n.push(s),e&&("weights"in e&&e.weights?n.push("weights",...e.weights):"weight"in e&&"number"==typeof e.weight&&n.push("weights",e.weight),"aggregate"in e&&n.push("aggregate",e.aggregate),e.withScores&&n.push("withscores")),super(n,i)}},eE=class extends p{constructor([t,s,e,i],n){let r=["zunionstore",t,s];Array.isArray(e)?r.push(...e):r.push(e),i&&("weights"in i&&i.weights?r.push("weights",...i.weights):"weight"in i&&"number"==typeof i.weight&&r.push("weights",i.weight),"aggregate"in i&&r.push("aggregate",i.aggregate)),super(r,n)}},eS=class extends p{constructor(t,s){super(["zdiffstore",...t],s)}},eA=class extends p{constructor(t,s){let[e,i]=t;super(["zmscore",e,...i],s)}},eT=class{constructor(t){if(this.exec=async t=>{if(0===this.commands.length)throw Error("Pipeline is empty");let s=this.multiExec?["multi-exec"]:["pipeline"],e=await this.client.request({path:s,body:Object.values(this.commands).map(t=>t.command)});return t?.keepErrors?e.map(({error:t,result:s},e)=>({error:t,result:this.commands[e].deserialize(s)})):e.map(({error:t,result:s},e)=>{if(t)throw new h(`Command ${e+1} [ ${this.commands[e].command[0]} ] failed: ${t}`);return this.commands[e].deserialize(s)})},this.append=(...t)=>this.chain(new u(t,this.commandOptions)),this.bitcount=(...t)=>this.chain(new d(t,this.commandOptions)),this.bitfield=(...t)=>new m(t,this.client,this.commandOptions,this.chain.bind(this)),this.bitop=(t,s,e,...i)=>this.chain(new x([t,s,e,...i],this.commandOptions)),this.bitpos=(...t)=>this.chain(new w(t,this.commandOptions)),this.clientSetinfo=(...t)=>this.chain(new y(t,this.commandOptions)),this.copy=(...t)=>this.chain(new g(t,this.commandOptions)),this.zdiffstore=(...t)=>this.chain(new eS(t,this.commandOptions)),this.dbsize=()=>this.chain(new O(this.commandOptions)),this.decr=(...t)=>this.chain(new f(t,this.commandOptions)),this.decrby=(...t)=>this.chain(new b(t,this.commandOptions)),this.del=(...t)=>this.chain(new E(t,this.commandOptions)),this.echo=(...t)=>this.chain(new S(t,this.commandOptions)),this.evalRo=(...t)=>this.chain(new A(t,this.commandOptions)),this.eval=(...t)=>this.chain(new T(t,this.commandOptions)),this.evalshaRo=(...t)=>this.chain(new R(t,this.commandOptions)),this.evalsha=(...t)=>this.chain(new z(t,this.commandOptions)),this.exists=(...t)=>this.chain(new N(t,this.commandOptions)),this.expire=(...t)=>this.chain(new k(t,this.commandOptions)),this.expireat=(...t)=>this.chain(new P(t,this.commandOptions)),this.flushall=t=>this.chain(new I(t,this.commandOptions)),this.flushdb=(...t)=>this.chain(new L(t,this.commandOptions)),this.geoadd=(...t)=>this.chain(new F(t,this.commandOptions)),this.geodist=(...t)=>this.chain(new _(t,this.commandOptions)),this.geopos=(...t)=>this.chain(new Y(t,this.commandOptions)),this.geohash=(...t)=>this.chain(new W(t,this.commandOptions)),this.geosearch=(...t)=>this.chain(new $(t,this.commandOptions)),this.geosearchstore=(...t)=>this.chain(new H(t,this.commandOptions)),this.get=(...t)=>this.chain(new B(t,this.commandOptions)),this.getbit=(...t)=>this.chain(new G(t,this.commandOptions)),this.getdel=(...t)=>this.chain(new K(t,this.commandOptions)),this.getex=(...t)=>this.chain(new q(t,this.commandOptions)),this.getrange=(...t)=>this.chain(new V(t,this.commandOptions)),this.getset=(t,s)=>this.chain(new Q([t,s],this.commandOptions)),this.hdel=(...t)=>this.chain(new Z(t,this.commandOptions)),this.hexists=(...t)=>this.chain(new tt(t,this.commandOptions)),this.hexpire=(...t)=>this.chain(new ts(t,this.commandOptions)),this.hexpireat=(...t)=>this.chain(new te(t,this.commandOptions)),this.hexpiretime=(...t)=>this.chain(new ti(t,this.commandOptions)),this.httl=(...t)=>this.chain(new tA(t,this.commandOptions)),this.hpexpire=(...t)=>this.chain(new tr(t,this.commandOptions)),this.hpexpireat=(...t)=>this.chain(new th(t,this.commandOptions)),this.hpexpiretime=(...t)=>this.chain(new tc(t,this.commandOptions)),this.hpttl=(...t)=>this.chain(new to(t,this.commandOptions)),this.hpersist=(...t)=>this.chain(new tn(t,this.commandOptions)),this.hget=(...t)=>this.chain(new ta(t,this.commandOptions)),this.hgetall=(...t)=>this.chain(new tp(t,this.commandOptions)),this.hgetdel=(...t)=>this.chain(new tu(t,this.commandOptions)),this.hgetex=(...t)=>this.chain(new td(t,this.commandOptions)),this.hincrby=(...t)=>this.chain(new tm(t,this.commandOptions)),this.hincrbyfloat=(...t)=>this.chain(new tx(t,this.commandOptions)),this.hkeys=(...t)=>this.chain(new tw(t,this.commandOptions)),this.hlen=(...t)=>this.chain(new ty(t,this.commandOptions)),this.hmget=(...t)=>this.chain(new tl(t,this.commandOptions)),this.hmset=(t,s)=>this.chain(new tg([t,s],this.commandOptions)),this.hrandfield=(t,s,e)=>this.chain(new l([t,s,e],this.commandOptions)),this.hscan=(...t)=>this.chain(new tO(t,this.commandOptions)),this.hset=(t,s)=>this.chain(new tf([t,s],this.commandOptions)),this.hsetex=(...t)=>this.chain(new tb(t,this.commandOptions)),this.hsetnx=(t,s,e)=>this.chain(new tE([t,s,e],this.commandOptions)),this.hstrlen=(...t)=>this.chain(new tS(t,this.commandOptions)),this.hvals=(...t)=>this.chain(new tT(t,this.commandOptions)),this.incr=(...t)=>this.chain(new tR(t,this.commandOptions)),this.incrby=(...t)=>this.chain(new tz(t,this.commandOptions)),this.incrbyfloat=(...t)=>this.chain(new tv(t,this.commandOptions)),this.keys=(...t)=>this.chain(new tQ(t,this.commandOptions)),this.lindex=(...t)=>this.chain(new tZ(t,this.commandOptions)),this.linsert=(t,s,e,i)=>this.chain(new t1([t,s,e,i],this.commandOptions)),this.llen=(...t)=>this.chain(new t0(t,this.commandOptions)),this.lmove=(...t)=>this.chain(new t2(t,this.commandOptions)),this.lpop=(...t)=>this.chain(new t5(t,this.commandOptions)),this.lmpop=(...t)=>this.chain(new t6(t,this.commandOptions)),this.lpos=(...t)=>this.chain(new t3(t,this.commandOptions)),this.lpush=(t,...s)=>this.chain(new t4([t,...s],this.commandOptions)),this.lpushx=(t,...s)=>this.chain(new t8([t,...s],this.commandOptions)),this.lrange=(...t)=>this.chain(new t9(t,this.commandOptions)),this.lrem=(t,s,e)=>this.chain(new t7([t,s,e],this.commandOptions)),this.lset=(t,s,e)=>this.chain(new st([t,s,e],this.commandOptions)),this.ltrim=(...t)=>this.chain(new ss(t,this.commandOptions)),this.mget=(...t)=>this.chain(new se(t,this.commandOptions)),this.mset=t=>this.chain(new si([t],this.commandOptions)),this.msetnx=t=>this.chain(new sn([t],this.commandOptions)),this.persist=(...t)=>this.chain(new sr(t,this.commandOptions)),this.pexpire=(...t)=>this.chain(new sh(t,this.commandOptions)),this.pexpireat=(...t)=>this.chain(new sc(t,this.commandOptions)),this.pfadd=(...t)=>this.chain(new so(t,this.commandOptions)),this.pfcount=(...t)=>this.chain(new sa(t,this.commandOptions)),this.pfmerge=(...t)=>this.chain(new sp(t,this.commandOptions)),this.ping=t=>this.chain(new sl(t,this.commandOptions)),this.psetex=(t,s,e)=>this.chain(new su([t,s,e],this.commandOptions)),this.pttl=(...t)=>this.chain(new sd(t,this.commandOptions)),this.publish=(...t)=>this.chain(new sm(t,this.commandOptions)),this.randomkey=()=>this.chain(new sx(this.commandOptions)),this.rename=(...t)=>this.chain(new sw(t,this.commandOptions)),this.renamenx=(...t)=>this.chain(new sy(t,this.commandOptions)),this.rpop=(...t)=>this.chain(new sg(t,this.commandOptions)),this.rpush=(t,...s)=>this.chain(new sO([t,...s],this.commandOptions)),this.rpushx=(t,...s)=>this.chain(new sf([t,...s],this.commandOptions)),this.sadd=(t,s,...e)=>this.chain(new sb([t,s,...e],this.commandOptions)),this.scan=(...t)=>this.chain(new sE(t,this.commandOptions)),this.scard=(...t)=>this.chain(new sS(t,this.commandOptions)),this.scriptExists=(...t)=>this.chain(new sA(t,this.commandOptions)),this.scriptFlush=(...t)=>this.chain(new sT(t,this.commandOptions)),this.scriptLoad=(...t)=>this.chain(new sR(t,this.commandOptions)),this.sdiff=(...t)=>this.chain(new sz(t,this.commandOptions)),this.sdiffstore=(...t)=>this.chain(new sv(t,this.commandOptions)),this.set=(t,s,e)=>this.chain(new sN([t,s,e],this.commandOptions)),this.setbit=(...t)=>this.chain(new sk(t,this.commandOptions)),this.setex=(t,s,e)=>this.chain(new sP([t,s,e],this.commandOptions)),this.setnx=(t,s)=>this.chain(new sC([t,s],this.commandOptions)),this.setrange=(...t)=>this.chain(new sU(t,this.commandOptions)),this.sinter=(...t)=>this.chain(new sI(t,this.commandOptions)),this.sinterstore=(...t)=>this.chain(new sL(t,this.commandOptions)),this.sismember=(t,s)=>this.chain(new sD([t,s],this.commandOptions)),this.smembers=(...t)=>this.chain(new sM(t,this.commandOptions)),this.smismember=(t,s)=>this.chain(new sj([t,s],this.commandOptions)),this.smove=(t,s,e)=>this.chain(new sJ([t,s,e],this.commandOptions)),this.spop=(...t)=>this.chain(new sX(t,this.commandOptions)),this.srandmember=(...t)=>this.chain(new sF(t,this.commandOptions)),this.srem=(t,...s)=>this.chain(new s_([t,...s],this.commandOptions)),this.sscan=(...t)=>this.chain(new sW(t,this.commandOptions)),this.strlen=(...t)=>this.chain(new sY(t,this.commandOptions)),this.sunion=(...t)=>this.chain(new s$(t,this.commandOptions)),this.sunionstore=(...t)=>this.chain(new sH(t,this.commandOptions)),this.time=()=>this.chain(new sB(this.commandOptions)),this.touch=(...t)=>this.chain(new sG(t,this.commandOptions)),this.ttl=(...t)=>this.chain(new sK(t,this.commandOptions)),this.type=(...t)=>this.chain(new sq(t,this.commandOptions)),this.unlink=(...t)=>this.chain(new sV(t,this.commandOptions)),this.zadd=(...t)=>(t[1],this.chain(new en([t[0],t[1],...t.slice(2)],this.commandOptions))),this.xadd=(...t)=>this.chain(new s1(t,this.commandOptions)),this.xack=(...t)=>this.chain(new sQ(t,this.commandOptions)),this.xackdel=(...t)=>this.chain(new sZ(t,this.commandOptions)),this.xdel=(...t)=>this.chain(new s6(t,this.commandOptions)),this.xdelex=(...t)=>this.chain(new s5(t,this.commandOptions)),this.xgroup=(...t)=>this.chain(new s3(t,this.commandOptions)),this.xread=(...t)=>this.chain(new et(t,this.commandOptions)),this.xreadgroup=(...t)=>this.chain(new es(t,this.commandOptions)),this.xinfo=(...t)=>this.chain(new s4(t,this.commandOptions)),this.xlen=(...t)=>this.chain(new s8(t,this.commandOptions)),this.xpending=(...t)=>this.chain(new s9(t,this.commandOptions)),this.xclaim=(...t)=>this.chain(new s2(t,this.commandOptions)),this.xautoclaim=(...t)=>this.chain(new s0(t,this.commandOptions)),this.xtrim=(...t)=>this.chain(new ei(t,this.commandOptions)),this.xrange=(...t)=>this.chain(new s7(t,this.commandOptions)),this.xrevrange=(...t)=>this.chain(new ee(t,this.commandOptions)),this.zcard=(...t)=>this.chain(new er(t,this.commandOptions)),this.zcount=(...t)=>this.chain(new eh(t,this.commandOptions)),this.zincrby=(t,s,e)=>this.chain(new ec([t,s,e],this.commandOptions)),this.zinterstore=(...t)=>this.chain(new eo(t,this.commandOptions)),this.zlexcount=(...t)=>this.chain(new ea(t,this.commandOptions)),this.zmscore=(...t)=>this.chain(new eA(t,this.commandOptions)),this.zpopmax=(...t)=>this.chain(new ep(t,this.commandOptions)),this.zpopmin=(...t)=>this.chain(new el(t,this.commandOptions)),this.zrange=(...t)=>this.chain(new eu(t,this.commandOptions)),this.zrank=(t,s)=>this.chain(new ed([t,s],this.commandOptions)),this.zrem=(t,...s)=>this.chain(new em([t,...s],this.commandOptions)),this.zremrangebylex=(...t)=>this.chain(new ex(t,this.commandOptions)),this.zremrangebyrank=(...t)=>this.chain(new ew(t,this.commandOptions)),this.zremrangebyscore=(...t)=>this.chain(new ey(t,this.commandOptions)),this.zrevrank=(t,s)=>this.chain(new eg([t,s],this.commandOptions)),this.zscan=(...t)=>this.chain(new eO(t,this.commandOptions)),this.zscore=(t,s)=>this.chain(new ef([t,s],this.commandOptions)),this.zunionstore=(...t)=>this.chain(new eE(t,this.commandOptions)),this.zunion=(...t)=>this.chain(new eb(t,this.commandOptions)),this.client=t.client,this.commands=[],this.commandOptions=t.commandOptions,this.multiExec=t.multiExec??!1,this.commandOptions?.latencyLogging){let t=this.exec.bind(this);this.exec=async s=>{let e=performance.now(),i=await (s?t(s):t()),n=performance.now(),r=(n-e).toFixed(2);return console.log(`Latency for \x1b[38;2;19;185;39m${this.multiExec?["MULTI-EXEC"]:["PIPELINE"].toString().toUpperCase()}\x1b[0m: \x1b[38;2;0;255;255m${r} ms\x1b[0m`),i}}}length(){return this.commands.length}chain(t){return this.commands.push(t),this}get json(){return{arrappend:(...t)=>this.chain(new tN(t,this.commandOptions)),arrindex:(...t)=>this.chain(new tk(t,this.commandOptions)),arrinsert:(...t)=>this.chain(new tP(t,this.commandOptions)),arrlen:(...t)=>this.chain(new tC(t,this.commandOptions)),arrpop:(...t)=>this.chain(new tU(t,this.commandOptions)),arrtrim:(...t)=>this.chain(new tI(t,this.commandOptions)),clear:(...t)=>this.chain(new tL(t,this.commandOptions)),del:(...t)=>this.chain(new tD(t,this.commandOptions)),forget:(...t)=>this.chain(new tM(t,this.commandOptions)),get:(...t)=>this.chain(new tj(t,this.commandOptions)),merge:(...t)=>this.chain(new tJ(t,this.commandOptions)),mget:(...t)=>this.chain(new tX(t,this.commandOptions)),mset:(...t)=>this.chain(new tF(t,this.commandOptions)),numincrby:(...t)=>this.chain(new t_(t,this.commandOptions)),nummultby:(...t)=>this.chain(new tW(t,this.commandOptions)),objkeys:(...t)=>this.chain(new tY(t,this.commandOptions)),objlen:(...t)=>this.chain(new t$(t,this.commandOptions)),resp:(...t)=>this.chain(new tH(t,this.commandOptions)),set:(...t)=>this.chain(new tB(t,this.commandOptions)),strappend:(...t)=>this.chain(new tG(t,this.commandOptions)),strlen:(...t)=>this.chain(new tK(t,this.commandOptions)),toggle:(...t)=>this.chain(new tq(t,this.commandOptions)),type:(...t)=>this.chain(new tV(t,this.commandOptions))}}get functions(){return{load:(...t)=>this.chain(new J(t,this.commandOptions)),list:(...t)=>this.chain(new j(t,this.commandOptions)),delete:(...t)=>this.chain(new D(t,this.commandOptions)),flush:()=>this.chain(new M(this.commandOptions)),stats:()=>this.chain(new X(this.commandOptions)),call:(...t)=>this.chain(new C(t,this.commandOptions)),callRo:(...t)=>this.chain(new U(t,this.commandOptions))}}},eR=new Set(["scan","keys","flushdb","flushall","dbsize","hscan","hgetall","hkeys","lrange","sscan","smembers","xrange","xrevrange","zscan","zrange","exec"]);function createAutoPipelineProxy(t,s="root"){return t.autoPipelineExecutor||(t.autoPipelineExecutor=new ez(t)),new Proxy(t,{get:(t,e)=>{if("pipelineCounter"===e)return t.autoPipelineExecutor.pipelineCounter;if("root"===s&&"json"===e)return createAutoPipelineProxy(t,"json");if("root"===s&&"functions"===e)return createAutoPipelineProxy(t,"functions");if("root"===s){let s=e in t&&!(e in t.autoPipelineExecutor.pipeline),i=eR.has(e);if(s||i)return t[e]}let i=t.autoPipelineExecutor.pipeline,n="json"===s?i.json[e]:"functions"===s?i.functions[e]:i[e];return"function"==typeof n?(...i)=>t.autoPipelineExecutor.withAutoPipeline(t=>{let n="json"===s?t.json[e]:"functions"===s?t.functions[e]:t[e];n(...i)}):n}})}var ez=class{constructor(t){this.pipelinePromises=new WeakMap,this.activePipeline=null,this.indexInCurrentPipeline=0,this.pipelineCounter=0,this.redis=t,this.pipeline=t.pipeline()}async withAutoPipeline(t){let s=this.activePipeline??this.redis.pipeline();this.activePipeline||(this.activePipeline=s,this.indexInCurrentPipeline=0);let e=this.indexInCurrentPipeline++;t(s);let i=this.deferExecution().then(()=>{if(!this.pipelinePromises.has(s)){let t=s.exec({keepErrors:!0});this.pipelineCounter+=1,this.pipelinePromises.set(s,t),this.activePipeline=null}return this.pipelinePromises.get(s)}),n=await i,r=n[e];if(r.error)throw new h(`Command failed: ${r.error}`);return r.result}async deferExecution(){await Promise.resolve(),await Promise.resolve()}},ev=class extends p{constructor(t,s){super([],{...s,headers:{Accept:"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"},path:["psubscribe",...t],streamOptions:{isStreaming:!0,onMessage:s?.streamOptions?.onMessage,signal:s?.streamOptions?.signal}})}},eN=class extends EventTarget{constructor(t,s,e=!1,i){for(let n of(super(),this.client=t,this.subscriptions=new Map,this.listeners=new Map,this.opts=i,s))e?this.subscribeToPattern(n):this.subscribeToChannel(n)}subscribeToChannel(t){let s=new AbortController,e=new ek([t],{streamOptions:{signal:s.signal,onMessage:t=>this.handleMessage(t,!1)}});e.exec(this.client).catch(t=>{"AbortError"!==t.name&&this.dispatchToListeners("error",t)}),this.subscriptions.set(t,{command:e,controller:s,isPattern:!1})}subscribeToPattern(t){let s=new AbortController,e=new ev([t],{streamOptions:{signal:s.signal,onMessage:t=>this.handleMessage(t,!0)}});e.exec(this.client).catch(t=>{"AbortError"!==t.name&&this.dispatchToListeners("error",t)}),this.subscriptions.set(t,{command:e,controller:s,isPattern:!0})}handleMessage(t,s){let e=t.replace(/^data:\s*/,""),i=e.indexOf(","),n=e.indexOf(",",i+1),r=s?e.indexOf(",",n+1):-1;if(-1!==i&&-1!==n){let t=e.slice(0,i);if(s&&"pmessage"===t&&-1!==r){let t=e.slice(i+1,n),s=e.slice(n+1,r),h=e.slice(r+1);try{let e=this.opts?.automaticDeserialization===!1?h:JSON.parse(h);this.dispatchToListeners("pmessage",{pattern:t,channel:s,message:e}),this.dispatchToListeners(`pmessage:${t}`,{pattern:t,channel:s,message:e})}catch(t){this.dispatchToListeners("error",Error(`Failed to parse message: ${t}`))}}else{let s=e.slice(i+1,n),r=e.slice(n+1);try{if("subscribe"===t||"psubscribe"===t||"unsubscribe"===t||"punsubscribe"===t){let s=Number.parseInt(r);this.dispatchToListeners(t,s)}else{let e=this.opts?.automaticDeserialization===!1?r:parseWithTryCatch(r);this.dispatchToListeners(t,{channel:s,message:e}),this.dispatchToListeners(`${t}:${s}`,{channel:s,message:e})}}catch(t){this.dispatchToListeners("error",Error(`Failed to parse message: ${t}`))}}}}dispatchToListeners(t,s){let e=this.listeners.get(t);if(e)for(let t of e)t(s)}on(t,s){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t)?.add(s)}removeAllListeners(){this.listeners.clear()}async unsubscribe(t){if(t)for(let s of t){let t=this.subscriptions.get(s);if(t){try{t.controller.abort()}catch{}this.subscriptions.delete(s)}}else{for(let t of this.subscriptions.values())try{t.controller.abort()}catch{}this.subscriptions.clear(),this.removeAllListeners()}}getSubscribedChannels(){return[...this.subscriptions.keys()]}},ek=class extends p{constructor(t,s){super([],{...s,headers:{Accept:"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"},path:["subscribe",...t],streamOptions:{isStreaming:!0,onMessage:s?.streamOptions?.onMessage,signal:s?.streamOptions?.signal}})}},parseWithTryCatch=t=>{try{return JSON.parse(t)}catch{return t}},eP=class{constructor(t,s){this.redis=t,this.script=s,this.sha1="",this.init(s)}async init(t){this.sha1||(this.sha1=await this.digest(t))}async eval(t,s){return await this.init(this.script),await this.redis.eval(this.script,t,s)}async evalsha(t,s){return await this.init(this.script),await this.redis.evalsha(this.sha1,t,s)}async exec(t,s){await this.init(this.script);let e=await this.redis.evalsha(this.sha1,t,s).catch(async e=>{if(e instanceof Error&&e.message.toLowerCase().includes("noscript"))return await this.redis.eval(this.script,t,s);throw e});return e}async digest(t){let s=new TextEncoder().encode(t),e=await n.digest("SHA-1",s),i=[...new Uint8Array(e)];return i.map(t=>t.toString(16).padStart(2,"0")).join("")}},eC=class{constructor(t,s){this.redis=t,this.sha1="",this.script=s,this.init(s)}async init(t){this.sha1||(this.sha1=await this.digest(t))}async evalRo(t,s){return await this.init(this.script),await this.redis.evalRo(this.script,t,s)}async evalshaRo(t,s){return await this.init(this.script),await this.redis.evalshaRo(this.sha1,t,s)}async exec(t,s){await this.init(this.script);let e=await this.redis.evalshaRo(this.sha1,t,s).catch(async e=>{if(e instanceof Error&&e.message.toLowerCase().includes("noscript"))return await this.redis.evalRo(this.script,t,s);throw e});return e}async digest(t){let s=new TextEncoder().encode(t),e=await n.digest("SHA-1",s),i=[...new Uint8Array(e)];return i.map(t=>t.toString(16).padStart(2,"0")).join("")}},eU=class{constructor(t,s){this.use=t=>{let s=this.client.request.bind(this.client);this.client.request=e=>t(e,s)},this.addTelemetry=t=>{if(this.enableTelemetry)try{this.client.mergeTelemetry(t)}catch{}},this.pipeline=()=>new eT({client:this.client,commandOptions:this.opts,multiExec:!1}),this.autoPipeline=()=>createAutoPipelineProxy(this),this.multi=()=>new eT({client:this.client,commandOptions:this.opts,multiExec:!0}),this.bitfield=(...t)=>new m(t,this.client,this.opts),this.append=(...t)=>new u(t,this.opts).exec(this.client),this.bitcount=(...t)=>new d(t,this.opts).exec(this.client),this.bitop=(t,s,e,...i)=>new x([t,s,e,...i],this.opts).exec(this.client),this.bitpos=(...t)=>new w(t,this.opts).exec(this.client),this.clientSetinfo=(...t)=>new y(t,this.opts).exec(this.client),this.copy=(...t)=>new g(t,this.opts).exec(this.client),this.dbsize=()=>new O(this.opts).exec(this.client),this.decr=(...t)=>new f(t,this.opts).exec(this.client),this.decrby=(...t)=>new b(t,this.opts).exec(this.client),this.del=(...t)=>new E(t,this.opts).exec(this.client),this.echo=(...t)=>new S(t,this.opts).exec(this.client),this.evalRo=(...t)=>new A(t,this.opts).exec(this.client),this.eval=(...t)=>new T(t,this.opts).exec(this.client),this.evalshaRo=(...t)=>new R(t,this.opts).exec(this.client),this.evalsha=(...t)=>new z(t,this.opts).exec(this.client),this.exec=t=>new v(t,this.opts).exec(this.client),this.exists=(...t)=>new N(t,this.opts).exec(this.client),this.expire=(...t)=>new k(t,this.opts).exec(this.client),this.expireat=(...t)=>new P(t,this.opts).exec(this.client),this.flushall=t=>new I(t,this.opts).exec(this.client),this.flushdb=(...t)=>new L(t,this.opts).exec(this.client),this.geoadd=(...t)=>new F(t,this.opts).exec(this.client),this.geopos=(...t)=>new Y(t,this.opts).exec(this.client),this.geodist=(...t)=>new _(t,this.opts).exec(this.client),this.geohash=(...t)=>new W(t,this.opts).exec(this.client),this.geosearch=(...t)=>new $(t,this.opts).exec(this.client),this.geosearchstore=(...t)=>new H(t,this.opts).exec(this.client),this.get=(...t)=>new B(t,this.opts).exec(this.client),this.getbit=(...t)=>new G(t,this.opts).exec(this.client),this.getdel=(...t)=>new K(t,this.opts).exec(this.client),this.getex=(...t)=>new q(t,this.opts).exec(this.client),this.getrange=(...t)=>new V(t,this.opts).exec(this.client),this.getset=(t,s)=>new Q([t,s],this.opts).exec(this.client),this.hdel=(...t)=>new Z(t,this.opts).exec(this.client),this.hexists=(...t)=>new tt(t,this.opts).exec(this.client),this.hexpire=(...t)=>new ts(t,this.opts).exec(this.client),this.hexpireat=(...t)=>new te(t,this.opts).exec(this.client),this.hexpiretime=(...t)=>new ti(t,this.opts).exec(this.client),this.httl=(...t)=>new tA(t,this.opts).exec(this.client),this.hpexpire=(...t)=>new tr(t,this.opts).exec(this.client),this.hpexpireat=(...t)=>new th(t,this.opts).exec(this.client),this.hpexpiretime=(...t)=>new tc(t,this.opts).exec(this.client),this.hpttl=(...t)=>new to(t,this.opts).exec(this.client),this.hpersist=(...t)=>new tn(t,this.opts).exec(this.client),this.hget=(...t)=>new ta(t,this.opts).exec(this.client),this.hgetall=(...t)=>new tp(t,this.opts).exec(this.client),this.hgetdel=(...t)=>new tu(t,this.opts).exec(this.client),this.hgetex=(...t)=>new td(t,this.opts).exec(this.client),this.hincrby=(...t)=>new tm(t,this.opts).exec(this.client),this.hincrbyfloat=(...t)=>new tx(t,this.opts).exec(this.client),this.hkeys=(...t)=>new tw(t,this.opts).exec(this.client),this.hlen=(...t)=>new ty(t,this.opts).exec(this.client),this.hmget=(...t)=>new tl(t,this.opts).exec(this.client),this.hmset=(t,s)=>new tg([t,s],this.opts).exec(this.client),this.hrandfield=(t,s,e)=>new l([t,s,e],this.opts).exec(this.client),this.hscan=(...t)=>new tO(t,this.opts).exec(this.client),this.hset=(t,s)=>new tf([t,s],this.opts).exec(this.client),this.hsetex=(...t)=>new tb(t,this.opts).exec(this.client),this.hsetnx=(t,s,e)=>new tE([t,s,e],this.opts).exec(this.client),this.hstrlen=(...t)=>new tS(t,this.opts).exec(this.client),this.hvals=(...t)=>new tT(t,this.opts).exec(this.client),this.incr=(...t)=>new tR(t,this.opts).exec(this.client),this.incrby=(...t)=>new tz(t,this.opts).exec(this.client),this.incrbyfloat=(...t)=>new tv(t,this.opts).exec(this.client),this.keys=(...t)=>new tQ(t,this.opts).exec(this.client),this.lindex=(...t)=>new tZ(t,this.opts).exec(this.client),this.linsert=(t,s,e,i)=>new t1([t,s,e,i],this.opts).exec(this.client),this.llen=(...t)=>new t0(t,this.opts).exec(this.client),this.lmove=(...t)=>new t2(t,this.opts).exec(this.client),this.lpop=(...t)=>new t5(t,this.opts).exec(this.client),this.lmpop=(...t)=>new t6(t,this.opts).exec(this.client),this.lpos=(...t)=>new t3(t,this.opts).exec(this.client),this.lpush=(t,...s)=>new t4([t,...s],this.opts).exec(this.client),this.lpushx=(t,...s)=>new t8([t,...s],this.opts).exec(this.client),this.lrange=(...t)=>new t9(t,this.opts).exec(this.client),this.lrem=(t,s,e)=>new t7([t,s,e],this.opts).exec(this.client),this.lset=(t,s,e)=>new st([t,s,e],this.opts).exec(this.client),this.ltrim=(...t)=>new ss(t,this.opts).exec(this.client),this.mget=(...t)=>new se(t,this.opts).exec(this.client),this.mset=t=>new si([t],this.opts).exec(this.client),this.msetnx=t=>new sn([t],this.opts).exec(this.client),this.persist=(...t)=>new sr(t,this.opts).exec(this.client),this.pexpire=(...t)=>new sh(t,this.opts).exec(this.client),this.pexpireat=(...t)=>new sc(t,this.opts).exec(this.client),this.pfadd=(...t)=>new so(t,this.opts).exec(this.client),this.pfcount=(...t)=>new sa(t,this.opts).exec(this.client),this.pfmerge=(...t)=>new sp(t,this.opts).exec(this.client),this.ping=t=>new sl(t,this.opts).exec(this.client),this.psetex=(t,s,e)=>new su([t,s,e],this.opts).exec(this.client),this.psubscribe=t=>{let s=Array.isArray(t)?t:[t];return new eN(this.client,s,!0,this.opts)},this.pttl=(...t)=>new sd(t,this.opts).exec(this.client),this.publish=(...t)=>new sm(t,this.opts).exec(this.client),this.randomkey=()=>new sx().exec(this.client),this.rename=(...t)=>new sw(t,this.opts).exec(this.client),this.renamenx=(...t)=>new sy(t,this.opts).exec(this.client),this.rpop=(...t)=>new sg(t,this.opts).exec(this.client),this.rpush=(t,...s)=>new sO([t,...s],this.opts).exec(this.client),this.rpushx=(t,...s)=>new sf([t,...s],this.opts).exec(this.client),this.sadd=(t,s,...e)=>new sb([t,s,...e],this.opts).exec(this.client),this.scard=(...t)=>new sS(t,this.opts).exec(this.client),this.scriptExists=(...t)=>new sA(t,this.opts).exec(this.client),this.scriptFlush=(...t)=>new sT(t,this.opts).exec(this.client),this.scriptLoad=(...t)=>new sR(t,this.opts).exec(this.client),this.sdiff=(...t)=>new sz(t,this.opts).exec(this.client),this.sdiffstore=(...t)=>new sv(t,this.opts).exec(this.client),this.set=(t,s,e)=>new sN([t,s,e],this.opts).exec(this.client),this.setbit=(...t)=>new sk(t,this.opts).exec(this.client),this.setex=(t,s,e)=>new sP([t,s,e],this.opts).exec(this.client),this.setnx=(t,s)=>new sC([t,s],this.opts).exec(this.client),this.setrange=(...t)=>new sU(t,this.opts).exec(this.client),this.sinter=(...t)=>new sI(t,this.opts).exec(this.client),this.sinterstore=(...t)=>new sL(t,this.opts).exec(this.client),this.sismember=(t,s)=>new sD([t,s],this.opts).exec(this.client),this.smismember=(t,s)=>new sj([t,s],this.opts).exec(this.client),this.smembers=(...t)=>new sM(t,this.opts).exec(this.client),this.smove=(t,s,e)=>new sJ([t,s,e],this.opts).exec(this.client),this.spop=(...t)=>new sX(t,this.opts).exec(this.client),this.srandmember=(...t)=>new sF(t,this.opts).exec(this.client),this.srem=(t,...s)=>new s_([t,...s],this.opts).exec(this.client),this.sscan=(...t)=>new sW(t,this.opts).exec(this.client),this.strlen=(...t)=>new sY(t,this.opts).exec(this.client),this.subscribe=t=>{let s=Array.isArray(t)?t:[t];return new eN(this.client,s,!1,this.opts)},this.sunion=(...t)=>new s$(t,this.opts).exec(this.client),this.sunionstore=(...t)=>new sH(t,this.opts).exec(this.client),this.time=()=>new sB().exec(this.client),this.touch=(...t)=>new sG(t,this.opts).exec(this.client),this.ttl=(...t)=>new sK(t,this.opts).exec(this.client),this.type=(...t)=>new sq(t,this.opts).exec(this.client),this.unlink=(...t)=>new sV(t,this.opts).exec(this.client),this.xadd=(...t)=>new s1(t,this.opts).exec(this.client),this.xack=(...t)=>new sQ(t,this.opts).exec(this.client),this.xackdel=(...t)=>new sZ(t,this.opts).exec(this.client),this.xdel=(...t)=>new s6(t,this.opts).exec(this.client),this.xdelex=(...t)=>new s5(t,this.opts).exec(this.client),this.xgroup=(...t)=>new s3(t,this.opts).exec(this.client),this.xread=(...t)=>new et(t,this.opts).exec(this.client),this.xreadgroup=(...t)=>new es(t,this.opts).exec(this.client),this.xinfo=(...t)=>new s4(t,this.opts).exec(this.client),this.xlen=(...t)=>new s8(t,this.opts).exec(this.client),this.xpending=(...t)=>new s9(t,this.opts).exec(this.client),this.xclaim=(...t)=>new s2(t,this.opts).exec(this.client),this.xautoclaim=(...t)=>new s0(t,this.opts).exec(this.client),this.xtrim=(...t)=>new ei(t,this.opts).exec(this.client),this.xrange=(...t)=>new s7(t,this.opts).exec(this.client),this.xrevrange=(...t)=>new ee(t,this.opts).exec(this.client),this.zadd=(...t)=>(t[1],new en([t[0],t[1],...t.slice(2)],this.opts).exec(this.client)),this.zcard=(...t)=>new er(t,this.opts).exec(this.client),this.zcount=(...t)=>new eh(t,this.opts).exec(this.client),this.zdiffstore=(...t)=>new eS(t,this.opts).exec(this.client),this.zincrby=(t,s,e)=>new ec([t,s,e],this.opts).exec(this.client),this.zinterstore=(...t)=>new eo(t,this.opts).exec(this.client),this.zlexcount=(...t)=>new ea(t,this.opts).exec(this.client),this.zmscore=(...t)=>new eA(t,this.opts).exec(this.client),this.zpopmax=(...t)=>new ep(t,this.opts).exec(this.client),this.zpopmin=(...t)=>new el(t,this.opts).exec(this.client),this.zrange=(...t)=>new eu(t,this.opts).exec(this.client),this.zrank=(t,s)=>new ed([t,s],this.opts).exec(this.client),this.zrem=(t,...s)=>new em([t,...s],this.opts).exec(this.client),this.zremrangebylex=(...t)=>new ex(t,this.opts).exec(this.client),this.zremrangebyrank=(...t)=>new ew(t,this.opts).exec(this.client),this.zremrangebyscore=(...t)=>new ey(t,this.opts).exec(this.client),this.zrevrank=(t,s)=>new eg([t,s],this.opts).exec(this.client),this.zscan=(...t)=>new eO(t,this.opts).exec(this.client),this.zscore=(t,s)=>new ef([t,s],this.opts).exec(this.client),this.zunion=(...t)=>new eb(t,this.opts).exec(this.client),this.zunionstore=(...t)=>new eE(t,this.opts).exec(this.client),this.client=t,this.opts=s,this.enableTelemetry=s?.enableTelemetry??!0,s?.readYourWrites===!1&&(this.client.readYourWrites=!1),this.enableAutoPipelining=s?.enableAutoPipelining??!0}get readYourWritesSyncToken(){return this.client.upstashSyncToken}set readYourWritesSyncToken(t){this.client.upstashSyncToken=t}get json(){return{arrappend:(...t)=>new tN(t,this.opts).exec(this.client),arrindex:(...t)=>new tk(t,this.opts).exec(this.client),arrinsert:(...t)=>new tP(t,this.opts).exec(this.client),arrlen:(...t)=>new tC(t,this.opts).exec(this.client),arrpop:(...t)=>new tU(t,this.opts).exec(this.client),arrtrim:(...t)=>new tI(t,this.opts).exec(this.client),clear:(...t)=>new tL(t,this.opts).exec(this.client),del:(...t)=>new tD(t,this.opts).exec(this.client),forget:(...t)=>new tM(t,this.opts).exec(this.client),get:(...t)=>new tj(t,this.opts).exec(this.client),merge:(...t)=>new tJ(t,this.opts).exec(this.client),mget:(...t)=>new tX(t,this.opts).exec(this.client),mset:(...t)=>new tF(t,this.opts).exec(this.client),numincrby:(...t)=>new t_(t,this.opts).exec(this.client),nummultby:(...t)=>new tW(t,this.opts).exec(this.client),objkeys:(...t)=>new tY(t,this.opts).exec(this.client),objlen:(...t)=>new t$(t,this.opts).exec(this.client),resp:(...t)=>new tH(t,this.opts).exec(this.client),set:(...t)=>new tB(t,this.opts).exec(this.client),strappend:(...t)=>new tG(t,this.opts).exec(this.client),strlen:(...t)=>new tK(t,this.opts).exec(this.client),toggle:(...t)=>new tq(t,this.opts).exec(this.client),type:(...t)=>new tV(t,this.opts).exec(this.client)}}get functions(){return{load:(...t)=>new J(t,this.opts).exec(this.client),list:(...t)=>new j(t,this.opts).exec(this.client),delete:(...t)=>new D(t,this.opts).exec(this.client),flush:()=>new M(this.opts).exec(this.client),stats:()=>new X(this.opts).exec(this.client),call:(...t)=>new C(t,this.opts).exec(this.client),callRo:(...t)=>new U(t,this.opts).exec(this.client)}}createScript(t,s){return s?.readonly?new eC(this,t):new eP(this,t)}scan(t,s){return new sE([t,s],this.opts).exec(this.client)}};"undefined"==typeof atob&&(global.atob=t=>Buffer.from(t,"base64").toString("utf8"));var eI=class _Redis extends eU{constructor(t){if("request"in t){super(t);return}t.url?(t.url.startsWith(" ")||t.url.endsWith(" ")||/\r|\n/.test(t.url))&&console.warn("[Upstash Redis] The redis url contains whitespace or newline, which can cause errors!"):console.warn("[Upstash Redis] The 'url' property is missing or undefined in your Redis config."),t.token?(t.token.startsWith(" ")||t.token.endsWith(" ")||/\r|\n/.test(t.token))&&console.warn("[Upstash Redis] The redis token contains whitespace or newline, which can cause errors!"):console.warn("[Upstash Redis] The 'token' property is missing or undefined in your Redis config.");let s=new a({baseUrl:t.url,retry:t.retry,headers:{authorization:`Bearer ${t.token}`},agent:t.agent,responseEncoding:t.responseEncoding,cache:t.cache??"no-store",signal:t.signal,keepAlive:t.keepAlive,readYourWrites:t.readYourWrites}),e="object"==typeof process&&process&&"object"==typeof process.env&&process.env?process.env:{};super(s,{automaticDeserialization:t.automaticDeserialization,enableTelemetry:t.enableTelemetry??!e.UPSTASH_DISABLE_TELEMETRY,latencyLogging:t.latencyLogging,enableAutoPipelining:t.enableAutoPipelining});let i="object"==typeof process&&process?process.version:void 0;if(this.addTelemetry({runtime:"string"==typeof EdgeRuntime?"edge-light":i?`node@${i}`:"unknown",platform:e.UPSTASH_CONSOLE?"console":e.VERCEL?"vercel":e.AWS_REGION?"aws":"unknown",sdk:"@upstash/redis@v1.36.2"}),this.enableAutoPipelining)return this.autoPipeline()}static fromEnv(t){if("object"!=typeof process||!process||"object"!=typeof process.env||!process.env)throw TypeError('[Upstash Redis] Unable to get environment variables, `process.env` is undefined. If you are deploying to cloudflare, please import from "@upstash/redis/cloudflare" instead');let s=process.env.UPSTASH_REDIS_REST_URL||process.env.KV_REST_API_URL;s||console.warn("[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_URL`");let e=process.env.UPSTASH_REDIS_REST_TOKEN||process.env.KV_REST_API_TOKEN;return e||console.warn("[Upstash Redis] Unable to find environment variable: `UPSTASH_REDIS_REST_TOKEN`"),new _Redis({...t,url:s,token:e})}}}};