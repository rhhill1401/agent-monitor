"use strict";(()=>{var e={};e.id=344,e.ids=[344],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6005:e=>{e.exports=require("node:crypto")},398:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>Z,originalPathname:()=>w,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>m});var s={};r.r(s),r.d(s,{DELETE:()=>DELETE,GET:()=>GET,POST:()=>POST,PUT:()=>PUT,dynamic:()=>u});var a=r(884),o=r(6132),n=r(5798),i=r(7862);let u="force-dynamic",c="franky:rules",l=[{id:"1",text:"No emojis in X posts",category:"posting",active:!0},{id:"2",text:"No em dashes - use regular dashes",category:"posting",active:!0},{id:"3",text:"Check content-queue.md before ANY post",category:"process",active:!0},{id:"4",text:"Never post to YouTube without Terry approval",category:"youtube",active:!0},{id:"5",text:"Research before title/timing recommendations",category:"process",active:!0}];async function GET(){try{let e=await i.Z.get(c);return e&&0!==e.length||(await i.Z.set(c,l),e=l),n.Z.json({rules:e})}catch(e){return console.error("Redis error:",e),n.Z.json({rules:l,error:"Using defaults"})}}async function POST(e){try{let t=await e.json();if(t.rules&&Array.isArray(t.rules))return await i.Z.set(c,t.rules),n.Z.json({success:!0,rules:t.rules});if(t.text){let e=await i.Z.get(c)||[],r={id:Date.now().toString(),text:t.text,category:t.category||"general",active:!0,createdAt:new Date().toISOString()};return e.push(r),await i.Z.set(c,e),n.Z.json({success:!0,rule:r})}return n.Z.json({error:"Invalid request"},{status:400})}catch(e){return console.error("Redis error:",e),n.Z.json({error:e.message},{status:500})}}async function PUT(e){try{let{id:t,...r}=await e.json();if(!t)return n.Z.json({error:"id required"},{status:400});let s=await i.Z.get(c)||[],a=s.findIndex(e=>e.id===t);if(-1===a)return n.Z.json({error:"Rule not found"},{status:404});return s[a]={...s[a],...r},await i.Z.set(c,s),n.Z.json({success:!0,rule:s[a]})}catch(e){return n.Z.json({error:e.message},{status:500})}}async function DELETE(e){try{let{searchParams:t}=new URL(e.url),r=t.get("id");if(!r)return n.Z.json({error:"id required"},{status:400});let s=await i.Z.get(c)||[];return s=s.filter(e=>e.id!==r),await i.Z.set(c,s),n.Z.json({success:!0})}catch(e){return n.Z.json({error:e.message},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/rules/route",pathname:"/api/rules",filename:"route",bundlePath:"app/api/rules/route"},resolvedPagePath:"/Users/Killmunger/clawd/apps/agent-monitor/app/api/rules/route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:y,headerHooks:Z,staticGenerationBailout:m}=d,w="/api/rules/route"},7862:(e,t,r)=>{r.d(t,{Z:()=>o});var s=r(1634);let a=new s.s({url:process.env.KV_REST_API_URL,token:process.env.KV_REST_API_TOKEN}),o=a}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[997,634],()=>__webpack_exec__(398));module.exports=r})();